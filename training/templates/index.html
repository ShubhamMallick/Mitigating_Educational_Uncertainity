<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéì Stream Recommendation System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4bb543;
            --warning: #f9c74f;
            --danger: #ef476f;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            font-family: 'Poppins', sans-serif;
            padding: 20px;
            min-height: 100vh;
            color: var(--dark);
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .main-container {
            display: flex;
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .sidebar-header {
            padding: 10px 0;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .sidebar-header h4 {
            color: var(--primary);
            font-weight: 600;
            margin: 0;
        }
        
        .sidebar .nav-link {
            color: var(--dark);
            padding: 12px 15px;
            border-radius: 8px;
            margin: 5px 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar .nav-link i {
            width: 20px;
            text-align: center;
        }
        
        .sidebar .nav-link:hover, 
        .sidebar .nav-link.active {
            background-color: var(--primary);
            color: white;
            text-decoration: none;
        }
        
        /* Tab Content */
        .tab-content {
            flex: 1;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        /* AI Guidance Styles */
        .ai-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .ai-message {
            display: flex;
            margin-bottom: 20px;
        }
        
        .ai-avatar {
            font-size: 24px;
            margin-right: 15px;
        }
        
        .ai-text {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            flex: 1;
        }
        
        .ai-options {
            margin-top: 30px;
        }
        
        .ai-option-card {
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .ai-option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .ai-option-card i {
            color: var(--primary);
            margin-right: 8px;
        }
        
        .ai-chat-container {
            margin-top: 30px;
            border: 1px solid #eee;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .chat-container {
            height: 500px;
            overflow-y: auto;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .chat-message {
            display: flex;
            max-width: 85%;
            margin-bottom: 15px;
        }
        
        .ai-message {
            align-self: flex-start;
        }
        
        .user-message {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .ai-avatar, .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 12px;
            background: var(--primary);
            color: white;
            flex-shrink: 0;
        }
        
        .user-avatar {
            background: var(--accent);
            margin-right: 0;
            margin-left: 12px;
        }
        
        .message-content {
            background: white;
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .ai-message .message-content {
            border-top-left-radius: 4px;
            background: #fff;
            border: 1px solid #e9ecef;
        }
        
        .user-message .message-content {
            background: var(--primary);
            color: white;
            border-top-right-radius: 4px;
        }
        
        .message-text {
            line-height: 1.5;
        }
        
        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .suggestions .badge {
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            padding: 6px 10px;
        }
        
        .suggestions .badge:hover {
            background: var(--primary) !important;
            color: white !important;
            transform: translateY(-2px);
        }
        
        .chat-input-container {
            padding: 0 10px;
        }
        
        .typing-indicator {
            display: inline-block;
            padding: 10px 15px;
            background: #f1f3f5;
            border-radius: 20px;
            margin-top: 5px;
            font-size: 14px;
            color: #6c757d;
        }
        
        .typing-indicator span {
            animation: bounce 1.4s infinite ease-in-out;
            display: inline-block;
            margin: 0 1px;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        /* Interest Assessment Styles */
        .result-card {
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ddd;
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .result-card.science {
            border-left-color: #198754; /* Green */
            background-color: rgba(25, 135, 84, 0.05);
        }
        
        .result-card.commerce {
            border-left-color: #0dcaf0; /* Cyan */
            background-color: rgba(13, 202, 240, 0.05);
        }
        
        .result-card.arts {
            border-left-color: #ffc107; /* Yellow */
            background-color: rgba(255, 193, 7, 0.05);
        }
        
        .result-card.vocational {
            border-left-color: #0d6efd; /* Blue */
            background-color: rgba(13, 110, 253, 0.05);
        }
        
        /* Quiz Card Styles */
        .quiz-card {
            transition: all 0.3s ease;
            border: none;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .quiz-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(13, 110, 253, 0.1);
        }
        
        .quiz-card[data-quiz="science"] .quiz-icon {
            background-color: rgba(25, 135, 84, 0.1);
        }
        
        .quiz-card[data-quiz="commerce"] .quiz-icon {
            background-color: rgba(13, 202, 240, 0.1);
        }
        
        .quiz-card[data-quiz="arts"] .quiz-icon {
            background-color: rgba(255, 193, 7, 0.1);
        }
        
        .quiz-card[data-quiz="vocational"] .quiz-icon {
            background-color: rgba(13, 110, 253, 0.1);
        }
        
        .quiz-meta {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
        }
        
        /* Quiz Question Styles */
        .question-container {
            padding: 20px;
            margin-bottom: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #0d6efd;
        }
        
        .option-btn {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 15px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            background-color: white;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .option-btn:hover {
            background-color: #f8f9fa;
            border-color: #0d6efd;
        }
        
        .option-btn.selected {
            background-color: #e7f1ff;
            border-color: #0d6efd;
            color: #0d6efd;
            font-weight: 500;
        }
        
        /* Result Score Styles */
        .result-score {
            font-size: 3rem;
            font-weight: 700;
            color: #198754;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .quiz-feedback {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .quiz-card {
                margin-bottom: 20px;
            }
            
            .result-card {
                margin-bottom: 15px;
            }
            
            .quiz-meta {
                flex-direction: column;
                gap: 5px;
            }
            
            .quiz-meta span {
                display: block;
                text-align: center;
            }
            
            .quiz-meta .mx-2 {
                display: none;
            }
        }
        
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }
        
        .ai-chat-input {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #eee;
        }
        
        .ai-chat-input input {
            flex: 1;
            margin-right: 10px;
        }

        /* Enhanced AI Career Advisor Styles */
        .ai-career-advisor-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);
            position: relative;
            animation: slideInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .ai-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px 30px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-header h4 {
            color: white;
            margin: 0 0 8px 0;
            font-size: 1.5rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .ai-header p {
            color: rgba(255, 255, 255, 0.8);
            margin: 0;
            font-size: 0.95rem;
        }

        .ai-chat-interface {
            background: white;
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            background-attachment: fixed;
        }

        .ai-chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .ai-chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .ai-chat-messages::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        .ai-chat-messages::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .ai-message-bubble {
            display: flex;
            margin-bottom: 20px;
            animation: messageSlideIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .ai-message-bubble.ai-message {
            justify-content: flex-start;
        }

        .ai-message-bubble.user-message {
            justify-content: flex-end;
        }

        .message-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 12px;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .message-avatar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 100%);
            border-radius: 50%;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .user-message .message-avatar {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            margin-right: 0;
            margin-left: 12px;
        }

        .message-content {
            max-width: 75%;
            padding: 16px 20px;
            border-radius: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            position: relative;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .ai-message .message-content {
            background: white;
            color: #2d3436;
            border-bottom-left-radius: 5px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .user-message .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-content::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 8px solid transparent;
        }

        .ai-message .message-content::after {
            left: -8px;
            top: 20px;
            border-right-color: white;
            border-left: 0;
        }

        .user-message .message-content::after {
            right: -8px;
            top: 20px;
            border-left-color: #667eea;
            border-right: 0;
        }

        .message-text {
            margin: 0;
            font-size: 0.95rem;
        }

        .message-suggestions {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .suggestion-badge {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 1px solid rgba(102, 126, 234, 0.3);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            display: inline-block;
        }

        .suggestion-badge:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 20px;
            margin: 10px 0;
            width: fit-content;
            animation: typingPulse 1.5s infinite;
        }

        .typing-indicator span {
            height: 8px;
            width: 8px;
            background: #667eea;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            animation: typingDots 1.5s infinite;
        }

        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes typingPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        @keyframes typingDots {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .ai-chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .ai-chat-input {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .ai-chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            outline: none;
        }

        .ai-chat-input input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .ai-chat-input button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .ai-chat-input button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        }

        .ai-chat-input button:active {
            transform: scale(0.95);
        }

        .ai-input-help {
            margin-top: 8px;
            font-size: 0.8rem;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .ai-input-help i {
            color: #667eea;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .ai-career-advisor-container {
                margin: 0 -15px;
                border-radius: 15px;
            }

            .ai-header {
                padding: 20px;
            }

            .ai-header h4 {
                font-size: 1.3rem;
            }

            .ai-chat-interface {
                height: 500px;
            }

            .message-content {
                max-width: 85%;
                padding: 12px 16px;
            }

            .message-avatar {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }

            .suggestion-badge {
                font-size: 0.75rem;
                padding: 4px 8px;
            }
        }

        /* Floating Animation for Avatars */
        .message-avatar {
            animation: floatAvatar 3s ease-in-out infinite;
        }

        .ai-message .message-avatar {
            animation-delay: 0s;
        }

        .user-message .message-avatar {
            animation-delay: 1.5s;
        }

        @keyframes floatAvatar {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }
        
        /* Counselor Styles */
        .counselor-profile {
            text-align: center;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .counselor-profile img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-bottom: 10px;
        }
        
        .counselor-profile h6 {
            margin: 10px 0 5px;
        }
        
        /* Assessment Styles */
        .options-container {
            display: grid;
            gap: 10px;
        }
        
        .option-btn {
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 8px;
            background: white;
            text-align: left;
            transition: all 0.3s;
        }
        
        .option-btn:hover, .option-btn.selected {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        /* Quiz Card Styles */
        .quiz-card {
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .quiz-icon {
            width: 60px;
            height: 60px;
            background: rgba(67, 97, 238, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .quiz-icon i {
            font-size: 24px;
            color: var(--primary);
        }
        
        .quiz-meta {
            margin-top: 15px;
        }
        
        .quiz-meta .badge {
            margin-right: 5px;
            font-weight: normal;
        }
        
        .content-area {
            flex: 1;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        
        
        .form-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(67, 97, 238, 0.1);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            transform: translateY(0);
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .form-container:hover {
            box-shadow: 0 15px 40px rgba(67, 97, 238, 0.2);
            transform: translateY(-5px);
        }
        .result-container {
            display: none;
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1) 0%, rgba(63, 55, 201, 0.1) 100%);
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.1);
        }
        
        /* AI Insights Styles */
        .ai-insights {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid #4cc9f0;
            transition: all 0.3s ease;
        }
        
        .ai-insights h4 {
            color: #3f37c9;
            margin-bottom: 0;
        }
        
        .insights-text {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
            line-height: 1.6;
        }
        
        .insights-text p:last-child {
            margin-bottom: 0;
        }
        
        .conversation-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            padding-right: 10px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
        }
        
        .user-message {
            background: #e3f2fd;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .ai-message {
            background: #f5f5f5;
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }
        
        .result-container.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        h1 {
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            background: linear-gradient(45deg, var(--primary), var(--accent));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 8s ease infinite;
            background-size: 200% 200%;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .form-section {
            margin-bottom: 25px;
            padding: 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.7);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid var(--primary);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transform: translateY(0);
        }
        
        .form-section.focused {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.15);
            background: white;
        }
        
        .form-section:hover {
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transform: translateX(5px);
        }
        
        .form-range::-webkit-slider-thumb {
            background: var(--primary);
            transition: all 0.3s ease;
        }
        
        .form-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px var(--primary);
        }
        
        .form-range::-moz-range-thumb {
            background: var(--primary);
            transition: all 0.3s ease;
        }
        
        .form-range::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px var(--primary);
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(67, 97, 238, 0.4);
            background: linear-gradient(45deg, var(--secondary), var(--primary));
        }
        
        .btn-primary:active {
            transform: translateY(1px);
        }
        
        /* Animated background elements */
        .bg-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-elements span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(67, 97, 238, 0.1);
            animation: animate 25s linear infinite;
            bottom: -150px;
            border-radius: 50%;
        }
        
        .bg-elements span:nth-child(1) {
            left: 25%;
            width: 80px;
            height: 80px;
            animation-delay: 0s;
        }
        
        .bg-elements span:nth-child(2) {
            left: 50%;
            width: 30px;
            height: 30px;
            animation-delay: 1.5s;
            animation-duration: 20s;
        }
        
        .bg-elements span:nth-child(3) {
            left: 70%;
            width: 100px;
            height: 100px;
            animation-delay: 5.5s;
        }
        
        @keyframes animate {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
                border-radius: 0;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
                border-radius: 50%;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background Elements -->
    <div class="bg-elements">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h4>Stream Selection Guidance</h4>
            </div>
            <ul class="nav flex-column">
                <!-- Home link removed as requested -->
                
                <!-- Stream Selection Section -->
                <li class="nav-item mt-3">
                    <div class="nav-link text-uppercase small fw-bold text-muted">
                        <i class="fas fa-graduation-cap me-2"></i> Stream Selection
                    </div>
                </li>
                <!-- Stream Explorer removed as requested -->
                <li class="nav-item">
                    <a class="nav-link" href="#interest-assessment" data-bs-toggle="tab">
                        <i class="fas fa-clipboard-check me-2"></i> Interest Assessment
                    </a>
                </li>
                
                <!-- Career Guidance Section -->
                <li class="nav-item mt-3">
                    <div class="nav-link text-uppercase small fw-bold text-muted">
                        <i class="fas fa-lightbulb me-2"></i> Career Guidance
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../career_path_visualization.html">
                        <i class="fas fa-project-diagram me-2"></i> Career Path Visualization
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#career-quizzes" data-bs-toggle="tab">
                        <i class="fas fa-question-circle me-2"></i> Career Quizzes
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#subject-quizzes" data-bs-toggle="tab">
                        <i class="fas fa-book me-2"></i> Subject Quizzes
                    </a>
                </li>
                
                <!-- Counseling Section -->
                <li class="nav-item mt-3">
                    <div class="nav-link text-uppercase small fw-bold text-muted">
                        <i class="fas fa-comments me-2"></i> Counseling
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#ai-guidance" data-bs-toggle="tab">
                        <i class="fas fa-robot me-2"></i> AI Career Advisor
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#mistral-counselor" data-bs-toggle="tab">
                        <i class="fas fa-brain me-2"></i> üß† Mistral AI Counselor
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#human-counselor" data-bs-toggle="tab">
                        <i class="fas fa-user-tie me-2"></i> Human Counselor
                    </a>
                </li>
            </ul>
        </div>
        
            <!-- Stream Recommendation Tab (Default) -->
            <div class="tab-pane fade show active" id="stream-recommendation">
                <h1 class="text-center">üéì Stream Recommendation System</h1>
        <p class="text-center mb-4">Enter your subject & aptitude scores to get personalized stream suggestions.</p>
        
        <div class="form-container">
            <form id="studentForm">
                <div class="row">
                    <div class="col-md-6">
                        <h4>üìò Academic Performance (Rate 0-100)</h4>
                        <p class="text-muted mb-3">Rate your academic performance in the following subjects. Be honest about your comfort level and understanding of each subject.</p>
                        
                        <div class="form-section">
                            <label for="math" class="form-label">Mathematics: <span id="mathValue">70</span>%</label>
                            <p class="small text-muted">How comfortable are you with numbers, calculations, and problem-solving? Rate your mathematical abilities and understanding of concepts.</p>
                            <input type="range" class="form-range" id="math" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="science" class="form-label">Science (Physics + Chemistry): <span id="scienceValue">70</span>%</label>
                            <p class="small text-muted">Rate your understanding of scientific concepts, experiments, and ability to apply scientific principles in real-world scenarios.</p>
                            <input type="range" class="form-range" id="science" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="biology" class="form-label">Biology: <span id="biologyValue">70</span>%</label>
                            <p class="small text-muted">How interested and knowledgeable are you about living organisms, human body systems, and biological processes?</p>
                            <input type="range" class="form-range" id="biology" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="english" class="form-label">English: <span id="englishValue">70</span>%</label>
                            <p class="small text-muted">Rate your proficiency in reading, writing, and understanding English language and literature.</p>
                            <input type="range" class="form-range" id="english" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="social" class="form-label">Social Studies: <span id="socialValue">70</span>%</label>
                            <p class="small text-muted">How interested and knowledgeable are you about history, geography, civics, and understanding societal structures?</p>
                            <input type="range" class="form-range" id="social" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="language" class="form-label">Language (Hindi/Other): <span id="languageValue">70</span>%</label>
                            <p class="small text-muted">Rate your proficiency in additional languages, including speaking, reading, and writing abilities.</p>
                            <input type="range" class="form-range" id="language" min="0" max="100" value="70">
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <h4>üß† Aptitude & Skills</h4>
                        <p class="text-muted mb-3">Rate your natural abilities and developed skills. Be honest about your strengths and areas for improvement.</p>
                        <div class="form-section">
                            <label for="logical" class="form-label">Logical Reasoning: <span id="logicalValue">70</span>%</label>
                            <p class="small text-muted">How good are you at analyzing patterns, solving puzzles, and thinking step-by-step to solve problems?</p>
                            <input type="range" class="form-range" id="logical" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="analytical" class="form-label">Analytical Skills: <span id="analyticalValue">70</span>%</label>
                            <p class="small text-muted">Can you break down complex problems into smaller parts and analyze them systematically?</p>
                            <input type="range" class="form-range" id="analytical" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="numerical" class="form-label">Numerical Ability: <span id="numericalValue">70</span>%</label>
                            <p class="small text-muted">How comfortable are you working with numbers, performing calculations, and interpreting numerical data?</p>
                            <input type="range" class="form-range" id="numerical" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="creativity" class="form-label">Creativity: <span id="creativityValue">70</span>%</label>
                            <p class="small text-muted">How would you rate your ability to think outside the box, generate new ideas, and find innovative solutions?</p>
                            <input type="range" class="form-range" id="creativity" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="communication" class="form-label">Communication Skills: <span id="communicationValue">70</span>%</label>
                            <p class="small text-muted">How effectively can you express your ideas and understand others, both in speaking and writing?</p>
                            <input type="range" class="form-range" id="communication" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="artistic" class="form-label">Artistic Skills: <span id="artisticValue">70</span>%</label>
                            <p class="small text-muted">How would you rate your abilities in visual arts, music, dance, or other creative expressions?</p>
                            <input type="range" class="form-range" id="artistic" min="0" max="100" value="70">
                        </div>
                        <div class="form-section">
                            <label for="practical" class="form-label">Practical Skills: <span id="practicalValue">70</span>%</label>
                            <p class="small text-muted">How good are you at hands-on tasks, applying knowledge practically, and solving real-world problems?</p>
                            <input type="range" class="form-range" id="practical" min="0" max="100" value="70">
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-primary btn-lg">üîç Recommend Stream</button>
                </div>
            </form>
        </div>

        <div id="resultContainer" class="result-container">
            <h3>‚úÖ Best Recommended Stream: <span id="bestStream"></span></h3>
            <div id="chart" style="width: 100%; height: 400px;"></div>
            
            <!-- Dashboard Link -->
            <div class="mt-4 text-center">
                <div class="alert alert-success">
                    <h5 class="alert-heading">üéâ Congratulations!</h5>
                    <p class="mb-2">Your stream recommendation has been saved and course recommendations have been generated for you!</p>
                    <p class="mb-3">View your personalized dashboard to see all recommendations and explore your educational path.</p>
                    <a href="/dashboard/" class="btn btn-success btn-lg">
                        <i class="fas fa-tachometer-alt me-2"></i>View My Dashboard
                    </a>
                </div>
            </div>
            
            <!-- AI Insights Section -->
            <div class="ai-insights mt-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4>ü§ñ AI Career Advisor</h4>
                    <button id="toggleInsights" class="btn btn-sm btn-outline-primary">Show Insights</button>
                </div>
                <div id="insightsContent" style="display: none;">
                    <div class="insights-loading text-center py-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2 mb-0">Analyzing your results...</p>
                    </div>
                    <div id="insightsText" class="insights-text" style="display: none;"></div>
                    
                    <div class="mt-4">
                        <h5>Ask a follow-up question:</h5>
                        <div class="input-group mb-3">
                            <input type="text" id="followUpQuestion" class="form-control" placeholder="Ask about career paths, skills, or opportunities...">
                            <button class="btn btn-primary" type="button" id="askQuestionBtn">Ask</button>
                        </div>
                        <div id="conversation" class="conversation-container"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Career Guidance Tab -->
        <div class="tab-pane fade" id="ai-guidance">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white">
                                <h4 class="mb-0"><i class="fas fa-robot me-2"></i>AI Career Advisor</h4>
                                <p class="mb-0 small">Ask me anything about careers, education paths, or skills development</p>
                            </div>
                            <div class="card-body">
                                <div id="aiChatContainer" class="chat-container">
                                    <div class="chat-message ai-message">
                                        <div class="ai-avatar">ü§ñ</div>
                                        <div class="message-content">
                                            <div class="message-text">Hello! I'm your Stream Selection Advisor for 10th grade. I can help you choose the right stream after your 10th board exams. Here are some common questions students ask:</div>
                                            <div class="suggestions mt-2">
                                                <span class="badge bg-light text-dark me-2 mb-2">Which stream should I choose?</span>
                                                <span class="badge bg-light text-dark me-2 mb-2">Science stream details</span>
                                                <span class="badge bg-light text-dark me-2 mb-2">Commerce stream options</span>
                                                <span class="badge bg-light text-dark me-2 mb-2">Arts/Humanities careers</span>
                                                <span class="badge bg-light text-dark me-2 mb-2">Vocational courses after 10th</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="chat-input-container mt-3">
                                    <div class="input-group">
                                        <input type="text" id="userMessage" class="form-control" placeholder="Type your career question here...">
                                        <button class="btn btn-primary" type="button" id="sendMessageBtn">
                                            <i class="fas fa-paper-plane"></i> Send
                                        </button>
                                    </div>
                                    <div class="form-text small text-muted mt-2">
                                        <i class="fas fa-info-circle me-1"></i> 
                                        I can help with career guidance, education paths, skill development, and more!
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of AI Career Guidance Tab -->

        <!-- Mistral AI Counselor Tab -->
        <div class="tab-pane fade" id="mistral-counselor">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <!-- Professional Header -->
                        <div class="text-center mb-4">
                            <h2 class="mb-2"><i class="fas fa-brain me-2 text-danger"></i>Mistral AI Career Counselor</h2>
                            <p class="text-muted">Advanced AI-powered career guidance and counseling</p>
                        </div>

                        <!-- Main Chat Interface -->
                        <div class="ai-career-advisor-container">
                            <div class="ai-header">
                                <h4><i class="fas fa-brain me-2"></i>AI Career Counseling Session</h4>
                                <p>Get personalized career guidance powered by Mistral AI</p>
                            </div>

                            <div class="ai-chat-interface">
                                <div class="ai-chat-messages" id="mistralChatContainer">
                                    <!-- Welcome Message -->
                                    <div class="ai-message-bubble ai-message">
                                        <div class="message-avatar">üß†</div>
                                        <div class="message-content">
                                            <div class="message-text">
                                                <strong>Welcome to your AI Career Counseling Session!</strong><br><br>
                                                I'm your dedicated AI Career Counselor powered by Mistral AI. I can help you with career planning, course recommendations, skill development, and job market insights.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Typing Indicator (initially hidden) -->
                                <div class="typing-indicator d-none">
                                    <span></span><span></span><span></span>
                                </div>

                                <!-- Chat Input -->
                                <div class="ai-chat-input-container">
                                    <div class="ai-chat-input">
                                        <input type="text" id="mistralUserMessage" class="form-control"
                                               placeholder="Ask me about your career, courses, or any questions...">
                                        <button class="btn" type="button" id="mistralSendMessageBtn">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    <div class="ai-input-help">
                                        <i class="fas fa-info-circle"></i>
                                        <small>Powered by Mistral AI for accurate, professional career guidance</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Mistral AI Counselor Tab -->

        <!-- Interest Assessment Tab -->
        <div class="tab-pane fade" id="interest-assessment">
            <div class="container py-4">
                <div class="text-center mb-5">
                    <h2 class="mb-3">üìä Interest Assessment</h2>
                    <p class="text-muted">Answer these questions to discover which stream matches your interests and strengths</p>
                </div>
                
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <div id="assessmentProgress" class="mb-4">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Progress</span>
                                <span id="progressText">1/15</span>
                            </div>
                            <div class="progress" style="height: 10px;">
                                <div id="progressBar" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div id="assessmentContainer">
                            <!-- Questions will be loaded here by JavaScript -->
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <button id="prevQuestionBtn" class="btn btn-outline-primary" disabled>
                                <i class="fas fa-arrow-left me-2"></i>Previous
                            </button>
                            <button id="nextQuestionBtn" class="btn btn-primary">
                                Next Question <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                            <button id="submitAssessmentBtn" class="btn btn-success d-none">
                                <i class="fas fa-check-circle me-2"></i>Get Results
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section (initially hidden) -->
                <div id="assessmentResults" class="mt-5 d-none">
                    <div class="card shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h4 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Your Stream Recommendation</h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="result-card science mb-4">
                                        <h5>Science Stream</h5>
                                        <div class="progress mb-2">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 0%"></div>
                                        </div>
                                        <p class="mb-0 small">Ideal for students interested in research, technology, medicine, or engineering.</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="result-card commerce mb-4">
                                        <h5>Commerce Stream</h5>
                                        <div class="progress mb-2">
                                            <div class="progress-bar bg-info" role="progressbar" style="width: 0%"></div>
                                        </div>
                                        <p class="mb-0 small">Perfect for those interested in business, finance, or entrepreneurship.</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="result-card arts mb-4">
                                        <h5>Arts/Humanities</h5>
                                        <div class="progress mb-2">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 0%"></div>
                                        </div>
                                        <p class="mb-0 small">Great for creative minds interested in literature, social sciences, or arts.</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="result-card vocational mb-4">
                                        <h5>Vocational Courses</h5>
                                        <div class="progress mb-2">
                                            <div class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
                                        </div>
                                        <p class="mb-0 small">Ideal for hands-on learners looking for skill-based education.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center mt-4">
                                <button id="retakeAssessmentBtn" class="btn btn-outline-primary me-2">
                                    <i class="fas fa-redo me-2"></i>Retake Assessment
                                </button>
                                <button id="exploreCareersBtn" class="btn btn-primary">
                                    <i class="fas fa-graduation-cap me-2"></i>Explore Career Options
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Interest Assessment Tab -->

        <!-- Career Quizzes Tab -->
        <div class="tab-pane fade" id="career-quizzes">
            <div class="container py-4">
                <div class="text-center mb-5">
                    <h2 class="mb-3">üß© Career Quizzes</h2>
                    <p class="text-muted">Take these quizzes to explore different career paths and find what suits you best</p>
                </div>
                
                <div class="row">
                    <!-- Science Stream Quiz -->
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card h-100 shadow-sm quiz-card" data-quiz="science">
                            <div class="card-body text-center p-4">
                                <div class="quiz-icon mb-3">
                                    <i class="fas fa-atom fa-3x text-primary"></i>
                                </div>
                                <h5 class="card-title">Science Stream Quiz</h5>
                                <p class="card-text small text-muted">Discover if Science is the right path for you</p>
                                <div class="quiz-meta small text-muted">
                                    <span><i class="far fa-question-circle me-1"></i> 12 Questions</span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span><i class="far fa-clock me-1"></i> 5 min</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent border-top-0 pb-3">
                                <button class="btn btn-outline-primary w-100 start-quiz-btn" data-quiz="science">
                                    Start Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Commerce Stream Quiz -->
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card h-100 shadow-sm quiz-card" data-quiz="commerce">
                            <div class="card-body text-center p-4">
                                <div class="quiz-icon mb-3">
                                    <i class="fas fa-chart-line fa-3x text-info"></i>
                                </div>
                                <h5 class="card-title">Commerce Stream Quiz</h5>
                                <p class="card-text small text-muted">Find out if Commerce matches your interests</p>
                                <div class="quiz-meta small text-muted">
                                    <span><i class="far fa-question-circle me-1"></i> 10 Questions</span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span><i class="far fa-clock me-1"></i> 4 min</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent border-top-0 pb-3">
                                <button class="btn btn-outline-info w-100 start-quiz-btn" data-quiz="commerce">
                                    Start Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Arts/Humanities Quiz -->
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card h-100 shadow-sm quiz-card" data-quiz="arts">
                            <div class="card-body text-center p-4">
                                <div class="quiz-icon mb-3">
                                    <i class="fas fa-palette fa-3x text-warning"></i>
                                </div>
                                <h5 class="card-title">Arts/Humanities Quiz</h5>
                                <p class="card-text small text-muted">Is Arts the right choice for you?</p>
                                <div class="quiz-meta small text-muted">
                                    <span><i class="far fa-question-circle me-1"></i> 8 Questions</span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span><i class="far fa-clock me-1"></i> 3 min</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent border-top-0 pb-3">
                                <button class="btn btn-outline-warning w-100 start-quiz-btn" data-quiz="arts">
                                    Start Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Vocational Courses Quiz -->
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card h-100 shadow-sm quiz-card" data-quiz="vocational">
                            <div class="card-body text-center p-4">
                                <div class="quiz-icon mb-3">
                                    <i class="fas fa-tools fa-3x text-primary"></i>
                                </div>
                                <h5 class="card-title">Vocational Courses Quiz</h5>
                                <p class="card-text small text-muted">Explore skill-based career options</p>
                                <div class="quiz-meta small text-muted">
                                    <span><i class="far fa-question-circle me-1"></i> 10 Questions</span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span><i class="far fa-clock me-1"></i> 4 min</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent border-top-0 pb-3">
                                <button class="btn btn-outline-primary w-100 start-quiz-btn" data-quiz="vocational">
                                    Start Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Container (initially hidden) -->
                <div id="quizContainer" class="mt-4 d-none">
                    <div class="card shadow-sm">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0" id="quizTitle">Quiz Title</h5>
                            <div class="d-flex align-items-center">
                                <span id="quizProgress" class="badge bg-white text-primary me-2">1/10</span>
                                <button id="exitQuizBtn" class="btn btn-sm btn-outline-light">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="quizQuestionContainer">
                                <!-- Quiz questions will be loaded here -->
                            </div>
                            
                            <div class="d-flex justify-content-between mt-4">
                                <button id="prevQuizQuestionBtn" class="btn btn-outline-primary" disabled>
                                    <i class="fas fa-arrow-left me-2"></i>Previous
                                </button>
                                <button id="nextQuizQuestionBtn" class="btn btn-primary">
                                    Next Question <i class="fas fa-arrow-right ms-2"></i>
                                </button>
                                <button id="submitQuizBtn" class="btn btn-success d-none">
                                    <i class="fas fa-check-circle me-2"></i>Submit Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Results (initially hidden) -->
                <div id="quizResults" class="mt-5 d-none">
                    <div class="card shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h4 class="mb-0"><i class="fas fa-trophy me-2"></i>Your Quiz Results</h4>
                        </div>
                        <div class="card-body">
                            <div class="text-center mb-4">
                                <div class="result-score mb-3">
                                    <span id="quizScore">0</span>%
                                </div>
                                <h4 id="quizResultTitle">Great Job!</h4>
                                <p class="text-muted" id="quizResultText">You have a good understanding of this stream.</p>
                            </div>
                            
                            <div class="quiz-feedback">
                                <h5><i class="fas fa-lightbulb me-2 text-warning"></i>Recommendation</h5>
                                <p id="quizRecommendation">Based on your answers, you might want to explore this stream further. Consider talking to a career counselor for personalized advice.</p>
                                
                                <div class="mt-4">
                                    <h6><i class="fas fa-book me-2 text-primary"></i>Suggested Next Steps</h6>
                                    <ul class="list-unstyled" id="quizNextSteps">
                                        <!-- Will be populated by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="text-center mt-4">
                                <button id="retakeQuizBtn" class="btn btn-outline-primary me-2">
                                    <i class="fas fa-redo me-2"></i>Retake Quiz
                                </button>
                                <button id="exploreMoreBtn" class="btn btn-primary">
                                    <i class="fas fa-search me-2"></i>Explore More Options
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Career Quizzes Tab -->

        <!-- Human Counselor Tab -->
        <div class="tab-pane fade" id="human-counselor">
            <div class="container py-5">
                <h1 class="text-center mb-4">üë®‚Äçüè´ Connect with Career Counselors</h1>
                <p class="text-center text-muted mb-5">Get personalized guidance from our certified career counselors</p>
                
                <div class="row">
                    <!-- Counselor 1 -->
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" class="card-img-top" alt="Counselor" style="height: 250px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">Dr. Rajesh Kumar</h5>
                                <p class="text-muted">Senior Career Counselor</p>
                                <div class="mb-3">
                                    <span class="badge bg-primary me-1">12+ years exp</span>
                                    <span class="badge bg-success">4.8 ‚òÖ</span>
                                </div>
                                <p class="card-text">Specializes in STEM career guidance and college admissions. Expert in helping students discover their true potential.</p>
                                <div class="d-grid">
                                    <button class="btn btn-outline-primary" onclick="showBookingModal('Dr. Rajesh Kumar')">
                                        <i class="fas fa-calendar-alt me-2"></i>Book Session
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Counselor 2 -->
                    <div class="col-md-4 mb-4">22225
                        <div class="card h-100 shadow-sm">
                            <img src="https://randomuser.me/api/portraits/women/44.jpg" class="card-img-top" alt="Counselor" style="height: 250px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">Priya Sharma</h5>
                                <p class="text-muted">Career & Education Consultant</p>
                                <div class="mb-3">
                                    <span class="badge bg-primary me-1">8+ years exp</span>
                                    <span class="badge bg-success">4.7 ‚òÖ</span>
                                </div>
                                <p class="card-text">Expert in humanities and arts streams. Helps students align their passions with rewarding career paths.</p>
                                <div class="d-grid">
                                    <button class="btn btn-outline-primary" onclick="showBookingModal('Priya Sharma')">
                                        <i class="fas fa-calendar-alt me-2"></i>Book Session
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Counselor 3 -->
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm">
                            <img src="https://randomuser.me/api/portraits/men/65.jpg" class="card-img-top" alt="Counselor" style="height: 250px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">Amit Patel</h5>
                                <p class="text-muted">Career Transition Coach</p>
                                <div class="mb-3">
                                    <span class="badge bg-primary me-1">10+ years exp</span>
                                    <span class="badge bg-success">4.9 ‚òÖ</span>
                                </div>
                                <p class="card-text">Specializes in helping students transition from academics to professional careers with practical guidance.</p>
                                <div class="d-grid">
                                    <button class="btn btn-outline-primary" onclick="showBookingModal('Amit Patel')">
                                        <i class="fas fa-calendar-alt me-2"></i>Book Session
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Booking Modal -->
            <div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Book a Session with <span id="counselorName"></span></h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="bookingForm">
                                <div class="mb-3">
                                    <label class="form-label">Select Date</label>
                                    <input type="date" class="form-control" id="appointmentDate" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Select Time Slot</label>
                                    <select class="form-select" id="timeSlot" required>
                                        <option value="">Choose a time slot</option>
                                        <option>10:00 AM - 11:00 AM</option>
                                        <option>11:30 AM - 12:30 PM</option>
                                        <option>2:00 PM - 3:00 PM</option>
                                        <option>4:00 PM - 5:00 PM</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Your Email</label>
                                    <input type="email" class="form-control" placeholder="Enter your email" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Any specific questions or topics?</label>
                                    <textarea class="form-control" rows="3" placeholder="Let us know what you'd like to discuss"></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-calendar-check me-2"></i>Confirm Booking
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Activity tracking function
        function trackActivity(type, title, data = {}) {
            const userId = localStorage.getItem('dashboard_user_id') || 'anonymous_' + Date.now();
            fetch('/api/dashboard/activity', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    user_id: userId,
                    type: type,
                    title: title,
                    description: title,
                    icon: 'fas fa-brain',
                    data: data,
                    page: 'stream-training',
                    action: 'visit'
                })
            });
        }

        // Track page visit
        document.addEventListener('DOMContentLoaded', function() {
            trackActivity('page_visit', 'Visited Stream Training Assessment', {
                page: 'stream-training',
                timestamp: new Date().toISOString()
            });
        });

        // Show booking modal with counselor name
        function showBookingModal(counselor) {
            document.getElementById('counselorName').textContent = counselor;
            const modal = new bootstrap.Modal(document.getElementById('bookingModal'));
            modal.show();
        }

        // Handle booking form submission
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Your session has been booked successfully! We will send you a confirmation email shortly.');
            const modal = bootstrap.Modal.getInstance(document.getElementById('bookingModal'));
            modal.hide();
        });
        // Update slider values
        const sliders = document.querySelectorAll('input[type="range"]');
        sliders.forEach(slider => {
            const valueSpan = document.getElementById(`${slider.id}Value`);
            slider.addEventListener('input', () => {
                valueSpan.textContent = slider.value;
            });
        });

        // Form submission
        document.getElementById('studentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.innerHTML = '‚è≥ Analyzing...';
            submitBtn.disabled = true;
            
            // Prepare data for API
            const formData = {
                math: parseInt(document.getElementById('math').value),
                science: parseInt(document.getElementById('science').value),
                biology: parseInt(document.getElementById('biology').value),
                english: parseInt(document.getElementById('english').value),
                social: parseInt(document.getElementById('social').value),
                language: parseInt(document.getElementById('language').value),
                logical: parseInt(document.getElementById('logical').value),
                analytical: parseInt(document.getElementById('analytical').value),
                numerical: parseInt(document.getElementById('numerical').value),
                creativity: parseInt(document.getElementById('creativity').value),
                communication: parseInt(document.getElementById('communication').value),
                artistic: parseInt(document.getElementById('artistic').value),
                practical: parseInt(document.getElementById('practical').value)
            };
            
            // Make API call to Flask backend
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // Store stream recommendation in user data store
                    const userId = localStorage.getItem('dashboard_user_id') || 'anonymous_' + Date.now();
                    
                    // Store stream recommendation data for dashboard
                    fetch('/api/set-recommended-stream', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            user_id: userId,
                            stream: data.best_stream,
                            scores: formData,
                            predictions: data.predictions
                        })
                    })
                    .then(response => response.json())
                    .then(streamData => {
                        console.log('Stream recommendation stored:', streamData);
                    })
                    .catch(error => {
                        console.error('Error storing stream recommendation:', error);
                    });
                    
                    // Track stream recommendation completion
                    trackActivity('stream_assessment', 'Stream Assessment Completed', {
                        recommended_stream: data.best_stream,
                        page: 'stream-training',
                        timestamp: new Date().toISOString()
                    });
                    
                    // Process successful response
                    const mockResponse = {
                        bestStream: data.best_stream,
                        probabilities: data.predictions.map(item => ({
                            stream: item.stream,
                            probability: item.probability
                        }))
                    };

                    // Set user context for AI chat and insights
                    setUserContext(data.best_stream, formData);

                    displayResults(mockResponse);
                } else {
                    throw new Error(data.message || 'Error processing your request');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalBtnText;
                submitBtn.disabled = false;
            });

// Function to display results
            function displayResults(mockResponse) {
                console.log('Displaying results:', mockResponse);
                
                // Fade in results
                const resultContainer = document.getElementById('resultContainer');
                resultContainer.style.display = 'block';
                
                // Start animations
                setTimeout(() => {
                    resultContainer.style.transition = 'opacity 0.8s ease-in-out';
                    resultContainer.style.opacity = '1';
                }, 50);
                
                // Typewriter effect for the best stream
                const bestStream = mockResponse.best_stream || mockResponse.bestStream;
                const bestStreamElement = document.getElementById('bestStream');
                
                if (bestStream && bestStreamElement) {
                    bestStreamElement.textContent = ''; // Clear previous content
                    let i = 0;
                    const speed = 50;
                    
                    function typeWriter() {
                        if (i < bestStream.length) {
                            bestStreamElement.textContent += bestStream.charAt(i);
                            i++;
                            setTimeout(typeWriter, speed);
                        }
                    }
                    
                    // Start the typewriter effect
                    typeWriter();
                }
                
                // Create chart data
                const chartData = [{
                    x: mockResponse.probabilities.map(item => item.stream),
                    y: mockResponse.probabilities.map(item => item.probability),
                    type: 'bar',
                    marker: {
                        color: ['#4361ee', '#3f37c9', '#4cc9f0', '#4895ef', '#3a0ca3'],
                        line: {
                            color: 'rgba(255,255,255,0.8)',
                            width: 2
                        },
                        opacity: 0.9
                    },
                    text: mockResponse.probabilities.map(item => `${item.probability.toFixed(2)}%`),
                    textposition: 'auto',
                    hoverinfo: 'text'
                }];

                // Create chart layout
                const layout = {
                title: {
                    text: 'Stream Recommendation Probabilities',
                    font: {
                        family: 'Poppins, sans-serif',
                        size: 20,
                        color: '#2d3436'
                    }
                },
                xaxis: { 
                    title: 'Streams',
                    tickfont: {
                        family: 'Poppins, sans-serif',
                        size: 12,
                        color: '#636363'
                    },
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.05)'
                },
                yaxis: { 
                    title: 'Probability (%)',
                    range: [0, 100],
                    tickfont: {
                        family: 'Poppins, sans-serif',
                        size: 12,
                        color: '#636363'
                    },
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.05)'
                },
                showlegend: false,
                paper_bgcolor: 'rgba(255,255,255,0.7)',
                plot_bgcolor: 'rgba(255,255,255,0.3)',
                margin: { t: 50, l: 50, r: 30, b: 70 },
                hovermode: 'closest'
            };

            // Create the plot
            Plotly.newPlot('chart', chartData, layout);
            
            // Scroll to results with smooth animation
            setTimeout(() => {
                resultContainer.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 1000);
        }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<script>
    // Toggle insights visibility
    document.getElementById('toggleInsights').addEventListener('click', function() {
        const insightsContent = document.getElementById('insightsContent');
        const isVisible = insightsContent.style.display === 'block';
        
        insightsContent.style.display = isVisible ? 'none' : 'block';
        this.textContent = isVisible ? 'Show Insights' : 'Hide Insights';
        
        // Load insights if showing for the first time
        if (!isVisible && !window.insightsLoaded) {
            loadInsights();
        }
    });
    
    // Load initial insights
    async function loadInsights() {
        const insightsContainer = document.getElementById('insightsContent');
        const loadingElement = insightsContainer.querySelector('.insights-loading');
        const insightsText = document.getElementById('insightsText');
        
        loadingElement.style.display = 'flex';
        insightsText.style.display = 'none';
        
        try {
            const response = await fetch('/get_insights', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    stream: window.currentStream,
                    scores: window.userScores
                })
            });
            
            const data = await response.json();
            
            if (data.status === 'success') {
                insightsText.innerHTML = formatInsights(data.insights);
                loadingElement.style.display = 'none';
                insightsText.style.display = 'block';
                window.insightsLoaded = true;
            } else {
                throw new Error(data.message || 'Failed to load insights');
            }
        } catch (error) {
            console.error('Error loading insights:', error);
            loadingElement.innerHTML = `
                <div class="alert alert-warning w-100 text-center">
                    Couldn't load insights. Please try again later.
                </div>
            `;
        }
    }
    
    // Format insights with proper line breaks and lists
    function formatInsights(text) {
        if (!text) return '';
        
        // Convert markdown-style formatting to HTML
        return text
            .split('\n\n')
            .map(paragraph => {
                // Handle bullet points and numbered lists
                if (paragraph.match(/^\s*[\-‚Ä¢*]\s+/)) {
                    return `<ul>${paragraph
                        .split('\n')
                        .map(item => item.replace(/^\s*[\-‚Ä¢*]\s+/, ''))
                        .map(item => `<li>${item}</li>`)
                        .join('')}</ul>`;
                } else if (paragraph.match(/^\s*\d+\.\s+/)) {
                    return `<ol>${paragraph
                        .split('\n')
                        .map(item => item.replace(/^\s*\d+\.\s+/, ''))
                        .map(item => `<li>${item}</li>`)
                        .join('')}</ol>`;
                }
                return `<p>${paragraph}</p>`;
            })
            .join('')
            .replace(/\n/g, '<br>');
    }
    // AI Guidance Functions
    function showAIChat(type) {
        document.querySelector('.ai-options').style.display = 'none';
        const chatContainer = document.querySelector('.ai-chat-container');
        const chatMessages = document.getElementById('aiChatMessages');
        
        // Clear previous messages
        chatMessages.innerHTML = '';
        
        // Add welcome message based on type
        let welcomeMessage = '';
        switch(type) {
            case 'explore':
                welcomeMessage = 'I can help you explore different career paths. What are you interested in learning more about?';
                break;
            case 'skills':
                welcomeMessage = 'Let\'s identify your key skills. What are you naturally good at?';
                break;
            case 'education':
                welcomeMessage = 'I can help you find the right education path. What field are you interested in?';
                break;
            case 'resume':
                welcomeMessage = 'I can help with resume and interview tips. What specific help do you need?';
                break;
            default:
                welcomeMessage = 'How can I help you today?';
        }
        
        addAIMessage(welcomeMessage);
        chatContainer.style.display = 'block';
        document.getElementById('userMessage').focus();
    }
    
    function addAIMessage(message) {
        const chatMessages = document.getElementById('aiChatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'ai-message';
        messageDiv.innerHTML = `
            <div class="ai-avatar">ü§ñ</div>
            <div class="ai-text">${message}</div>
        `;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function sendAIMessage() {
        const input = document.getElementById('userMessage');
        const message = input.value.trim();
        
        if (message) {
            // Add user message
            const chatMessages = document.getElementById('aiChatMessages');
            const userMessageDiv = document.createElement('div');
            userMessageDiv.className = 'ai-message user-message';
            userMessageDiv.innerHTML = `
                <div class="ai-text" style="background: #e3f2fd; margin-left: auto;">${message}</div>
                <div class="ai-avatar">üë§</div>
            `;
            chatMessages.appendChild(userMessageDiv);
            
            // Clear input
            input.value = '';
            
            // Simulate AI response (in a real app, this would be an API call)
            setTimeout(() => {
                const responses = [
                    "That's an interesting question. Let me think about that...",
                    "I can help with that. Here's what I know...",
                    "Based on your interests, I'd recommend...",
                    "That's a great area to explore. Have you considered..."
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addAIMessage(randomResponse);
            }, 1000);
        }
    }
    
    // Allow pressing Enter to send message
    document.getElementById('userMessage').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendAIMessage();
        }
    });
    
    // Assessment Functions
    let currentQuestion = 0;
    const totalQuestions = 5; // For demo purposes
    
    function startAssessment() {
        document.getElementById('assessmentIntro').style.display = 'none';
        document.getElementById('assessmentQuestions').style.display = 'block';
        showQuestion(0);
    }
    
    function showQuestion(index) {
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('questionOptions');
        
        // Update progress
        const progress = ((index + 1) / totalQuestions) * 100;
        document.getElementById('assessmentProgress').style.width = `${progress}%`;
        
        // Update question number
        questionText.textContent = `Question ${index + 1}/${totalQuestions}`;
        
        // Sample question (in a real app, these would come from a data source)
        const questions = [
            "I enjoy working with numbers and solving mathematical problems.",
            "I like conducting experiments and understanding how things work.",
            "I'm interested in learning about different cultures and societies.",
            "I enjoy creating art, music, or other creative works.",
            "I like helping others and working in teams."
        ];
        
        questionText.textContent += `: ${questions[index]}`;
        
        // Add options
        const options = [
            "Strongly Disagree",
            "Disagree",
            "Neutral",
            "Agree",
            "Strongly Agree"
        ];
        
        let optionsHTML = '';
        options.forEach((option, i) => {
            optionsHTML += `
                <button class="option-btn" onclick="selectOption(this, ${i})">
                    ${option}
                </button>
            `;
        });
        
        optionsContainer.innerHTML = optionsHTML;
        
        // Update button states
        document.getElementById('prevQuestion').disabled = index === 0;
        document.getElementById('nextQuestion').textContent = index === totalQuestions - 1 ? 'Finish' : 'Next';
    }
    
    function selectOption(button, optionIndex) {
        // Remove selected class from all options
        const options = document.querySelectorAll('.option-btn');
        options.forEach(opt => opt.classList.remove('selected'));
        
        // Add selected class to clicked option
        button.classList.add('selected');
    }
    
    // Quiz Functions
    function startQuiz(type) {
        // In a real app, this would start the selected quiz
        alert(`Starting ${type} quiz! This would navigate to the quiz page in a real application.`);
    }
    
    // Initialize Bootstrap tabs
    var triggerTabList = [].slice.call(document.querySelectorAll('a[data-bs-toggle="tab"]'));
    triggerTabList.forEach(function (triggerEl) {
        var tabTrigger = new bootstrap.Tab(triggerEl);
        triggerEl.addEventListener('click', function (event) {
            event.preventDefault();
            tabTrigger.show();
        });
    });

    // AI Career Chat Functionality
    const chatContainer = document.getElementById('aiChatContainer');
    const userInput = document.getElementById('userMessage');
    const sendButton = document.getElementById('sendMessageBtn');
    const suggestionBadges = document.querySelectorAll('.suggestions .badge');
    
    // Add click handler for suggestion badges
    suggestionBadges.forEach(badge => {
        badge.addEventListener('click', () => {
            userInput.value = badge.textContent.trim();
            userInput.focus();
        });
    });
    
    // Send message function
    function sendMessage() {
        const message = userInput.value.trim();
        if (!message) return;
        
        // Add user message to chat
        addMessage(message, 'user');
        userInput.value = '';
        
        // Show typing indicator
        showTypingIndicator();
        
        // Simulate AI response (in a real app, this would be an API call)
        setTimeout(() => {
            // Remove typing indicator
            const typingIndicator = document.querySelector('.typing-indicator');
            if (typingIndicator) typingIndicator.remove();
            
            // Add AI response
            getAIResponse(message).then(response => {
                addMessage(response, 'ai');
                // Auto-scroll to bottom
                chatContainer.scrollTop = chatContainer.scrollHeight;
            });
        }, 1000);
    }
    
    // Add message to chat
    function addMessage(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${sender}-message`;
        
        const avatar = document.createElement('div');
        avatar.className = `${sender}-avatar`;
        avatar.textContent = sender === 'ai' ? 'ü§ñ' : 'üë§';
        
        const content = document.createElement('div');
        content.className = 'message-content';
        
        const messageText = document.createElement('div');
        messageText.className = 'message-text';
        messageText.innerHTML = formatMessage(text);
        
        content.appendChild(messageText);
        messageDiv.appendChild(avatar);
        messageDiv.appendChild(content);
        
        chatContainer.appendChild(messageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    // Format message (simple markdown to HTML)
    function formatMessage(text) {
        // Convert line breaks to <br>
        return text.replace(/\n/g, '<br>')
                  // Convert **bold** to <strong>
                  .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                  // Convert *italic* to <em>
                  .replace(/\*(.*?)\*/g, '<em>$1</em>');
    }
    
    // Show typing indicator
    function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'typing-indicator';
        typingDiv.innerHTML = 'AI is thinking <span>.</span><span>.</span><span>.</span>';
        chatContainer.appendChild(typingDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    // Set user context after stream recommendation
    window.currentStream = null;
    window.userScores = {};

    // Function to set user context after prediction
    function setUserContext(stream, scores) {
        window.currentStream = stream;
        window.userScores = scores;

        // Generate a unique user ID if not exists
        if (!window.userId) {
            window.userId = 'user_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Store in session via API
        fetch('/api/set-recommended-stream', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                stream: stream,
                scores: scores,
                user_id: window.userId  // Include user_id in the request
            })
        }).catch(error => {
            console.error('Error storing user context:', error);
        });
    }

    // Simulate AI response for 10th-grade stream selection
    async function getAIResponse(message) {
        // This is a mock response - replace with actual API call
        const responses = {
            'science stream': 'The Science stream (PCM/PCB) is ideal if you enjoy subjects like Physics, Chemistry, and Mathematics/Biology. It opens doors to careers in Engineering, Medicine, Research, and Technology. You should have strong analytical skills and a curiosity about how things work. Would you like to know more about career options in Science?',
            'commerce stream': 'The Commerce stream focuses on subjects like Accountancy, Business Studies, and Economics. It\'s perfect if you\'re interested in business, finance, or entrepreneurship. Career options include CA, CS, BBA, and Economics. Do you have a specific career in mind?',
            'arts/humanities': 'The Arts/Humanities stream includes subjects like History, Political Science, Psychology, and Languages. It\'s great for careers in Law, Media, Design, Social Work, and Civil Services. Would you like to explore specific career paths in Arts?',
            'vocational courses': 'Vocational courses provide practical skills in fields like IT, Hospitality, Design, and more. They\'re career-focused and can lead to jobs right after 12th. Would you like information about specific vocational courses?',
            'which stream should i choose': 'Choosing a stream depends on your interests, strengths, and career goals. I can help you identify the right fit. Could you tell me which subjects you enjoy the most and what kind of work interests you?',
            'career options after 10th': 'After 10th, you can choose between Science, Commerce, Arts, or Vocational streams. Each leads to different career paths. Would you like to know more about any specific stream?',
            'default': 'I\'m here to help you choose the right stream after 10th grade! You can ask me about different streams, subjects, career options, or how to decide what\'s best for you. What would you like to know?'
        };

        // Find matching response or use default
        const lowerMessage = message.toLowerCase();
        for (const [key, response] of Object.entries(responses)) {
            if (lowerMessage.includes(key)) {
                return response;
            }
        }
        return responses['default'];
    }
    
    // Mistral AI Counselor Functions
    function showMistralCounselingOptions(topic) {
        const optionsContainer = document.getElementById('mistral-counseling-options');
        const mainInterface = document.getElementById('mistral-chat-interface');
        const counselingTitle = document.getElementById('mistral-counseling-title');
        const counselingContent = document.getElementById('mistral-counseling-content');

        // Hide main interface, show options
        mainInterface.classList.add('d-none');
        optionsContainer.classList.remove('d-none');

        // Set title and content based on topic
        let title = '';
        let content = '';

        switch(topic) {
            case 'career-assessment':
                title = '<i class="fas fa-clipboard-check me-2"></i>Comprehensive Career Assessment';
                content = `
                    <div class="mb-4">
                        <h6>üìä Advanced Career Assessment</h6>
                        <p class="text-muted">Get a comprehensive analysis of your career interests, personality traits, and market opportunities using AI-powered assessment tools.</p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('career-assessment')">
                                <h6><i class="fas fa-search me-2 text-danger"></i>Interest Analysis</h6>
                                <p class="small text-muted">Analyze your interests and passions for career matching</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('personality-assessment')">
                                <h6><i class="fas fa-user-check me-2 text-success"></i>Personality Assessment</h6>
                                <p class="small text-muted">Understand your personality type and work preferences</p>
                            </div>
                        </div>
                    </div>`;
                break;

            case 'course-recommendation':
                title = '<i class="fas fa-graduation-cap me-2"></i>Course Recommendations';
                content = `
                    <div class="mb-4">
                        <h6>üéì Personalized Course Recommendations</h6>
                        <p class="text-muted">Get tailored course suggestions based on your career goals, interests, and current market demands.</p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('degree-recommendations')">
                                <h6><i class="fas fa-certificate me-2 text-primary"></i>Degree Programs</h6>
                                <p class="small text-muted">Find the best degree programs for your career path</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('certification-courses')">
                                <h6><i class="fas fa-award me-2 text-warning"></i>Certifications</h6>
                                <p class="small text-muted">Discover valuable certifications to boost your resume</p>
                            </div>
                        </div>
                    </div>`;
                break;

            case 'skill-development':
                title = '<i class="fas fa-chart-line me-2"></i>Skill Development Planning';
                content = `
                    <div class="mb-4">
                        <h6>üìà Strategic Skill Development</h6>
                        <p class="text-muted">Create a comprehensive plan to develop the skills needed for your target career with AI-powered insights.</p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('skill-gap-analysis')">
                                <h6><i class="fas fa-search me-2 text-info"></i>Skill Gap Analysis</h6>
                                <p class="small text-muted">Identify skills you need to develop for your career</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('learning-path')">
                                <h6><i class="fas fa-route me-2 text-success"></i>Learning Path</h6>
                                <p class="small text-muted">Get a structured learning plan for skill development</p>
                            </div>
                        </div>
                    </div>`;
                break;

            case 'career-planning':
                title = '<i class="fas fa-road me-2"></i>Career Planning & Strategy';
                content = `
                    <div class="mb-4">
                        <h6>üó∫Ô∏è Strategic Career Planning</h6>
                        <p class="text-muted">Develop a comprehensive career strategy with timeline, milestones, and actionable steps using AI insights.</p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('career-roadmap')">
                                <h6><i class="fas fa-map me-2 text-primary"></i>Career Roadmap</h6>
                                <p class="small text-muted">Create a detailed career progression plan</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="counseling-topic-card p-3 border rounded mb-3" onclick="startMistralCounselingChat('job-search-strategy')">
                                <h6><i class="fas fa-bullseye me-2 text-danger"></i>Job Search Strategy</h6>
                                <p class="small text-muted">Optimize your job search and application process</p>
                            </div>
                        </div>
                    </div>`;
                break;

            default:
                title = '<i class="fas fa-question-circle me-2"></i>General AI Counseling';
                content = `
                    <div class="mb-4">
                        <h6>ü§ñ General AI Career Counseling</h6>
                        <p class="text-muted">Ask me any career-related questions and get AI-powered guidance and recommendations.</p>
                    </div>
                    <div class="text-center">
                        <button class="btn btn-danger" onclick="startMistralCounselingChat('general')">
                            <i class="fas fa-comments me-2"></i>Start General Counseling
                        </button>
                    </div>`;
        }

        counselingTitle.innerHTML = title;
        counselingContent.innerHTML = content;
    }

    function hideMistralCounselingOptions() {
        const optionsContainer = document.getElementById('mistral-counseling-options');
        const mainInterface = document.getElementById('mistral-chat-interface');

        optionsContainer.classList.add('d-none');
        mainInterface.classList.remove('d-none');
    }

    function startMistralCounselingChat(topic) {
        // Send initial message based on topic
        let initialMessage = '';

        switch(topic) {
            case 'career-assessment':
                initialMessage = "I need a comprehensive career assessment. Can you analyze my interests and suggest suitable career paths?";
                break;
            case 'personality-assessment':
                initialMessage = "Can you help me understand my personality type and how it relates to career choices?";
                break;
            case 'degree-recommendations':
                initialMessage = "I need recommendations for degree programs that match my career goals and interests.";
                break;
            case 'certification-courses':
                initialMessage = "What certifications would be most valuable for my career development?";
                break;
            case 'skill-gap-analysis':
                initialMessage = "Can you help me identify the skills I need to develop for my target career?";
                break;
            case 'learning-path':
                initialMessage = "I need a structured learning path to develop the skills for my chosen career.";
                break;
            case 'career-roadmap':
                initialMessage = "Can you help me create a detailed career roadmap with milestones and timelines?";
                break;
            case 'job-search-strategy':
                initialMessage = "I need help optimizing my job search strategy and application process.";
                break;
            default:
                initialMessage = "I need career counseling from your AI perspective. Can you help me with my questions?";
        }

        // Hide options and show chat
        hideMistralCounselingOptions();

        // Send the initial message
        setTimeout(() => {
            const userInput = document.getElementById('mistralUserMessage');
            userInput.value = initialMessage;
            sendMistralMessage();
        }, 500);
    }

    function startNewMistralSession() {
        // Clear chat and show welcome message
        const chatContainer = document.getElementById('mistralChatContainer');
        chatContainer.innerHTML = `
            <div class="chat-message ai-message">
                <div class="ai-avatar">üß†</div>
                <div class="message-content">
                    <div class="message-text">
                        <strong>Welcome to your new Mistral AI Career Counseling Session!</strong><br><br>
                        I'm ready to provide you with advanced AI-powered career guidance and insights.
                    </div>
                </div>
            </div>
        `;

        // Hide session summary
        document.getElementById('mistral-session-summary').classList.add('d-none');
    }

    function saveMistralSession() {
        // Generate session summary
        const chatMessages = document.querySelectorAll('#mistralChatContainer .chat-message');
        let conversation = [];

        chatMessages.forEach(msg => {
            const isAI = msg.classList.contains('ai-message');
            const text = msg.querySelector('.message-text').textContent;
            conversation.push({
                role: isAI ? 'mistral-counselor' : 'user',
                message: text
            });
        });

        // Create summary
        const summaryContent = document.getElementById('mistral-summary-content');
        summaryContent.innerHTML = `
            <p><strong>Session Date:</strong> ${new Date().toLocaleDateString()}</p>
            <p><strong>Total Messages:</strong> ${conversation.length}</p>
            <p><strong>Counselor:</strong> Mistral AI Career Counselor</p>
            <div class="mt-3">
                <h6>AI-Generated Insights:</h6>
                <ul>
                    <li>Advanced career assessment and analysis</li>
                    <li>Personalized course and skill recommendations</li>
                    <li>Data-driven career planning strategies</li>
                    <li>Market trend analysis and job outlook</li>
                </ul>
            </div>
        `;

        // Show summary
        document.getElementById('mistral-session-summary').classList.remove('d-none');

        // Offer to download or save
        if (confirm('Would you like to download a summary of this AI counseling session?')) {
            downloadMistralSessionSummary(conversation);
        }
    }

    function downloadMistralSessionSummary(conversation) {
        const summary = conversation.map(msg =>
            `${msg.role.toUpperCase()}: ${msg.message}`
        ).join('\n\n');

        const blob = new Blob([`Mistral AI Career Counseling Session Summary\n\n${summary}`], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `mistral-ai-counseling-session-${new Date().toISOString().split('T')[0]}.txt`;
        a.click();
        window.URL.revokeObjectURL(url);
    }

    // Mistral AI Chat message sending function
    async function sendMistralMessage() {
        const message = document.getElementById('mistralUserMessage').value.trim();
        if (!message) return;

        // Add user message to chat
        addMistralMessage(message, 'user');
        document.getElementById('mistralUserMessage').value = '';

        // Show typing indicator
        showMistralTypingIndicator();

        try {
            // Ensure we have a user ID
            if (!window.userId) {
                window.userId = 'user_' + Math.random().toString(36).substr(2, 9);
            }
            
            // Call the Mistral backend API
            const response = await fetch('/api/mistral-chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: message,
                    user_id: window.userId,
                    context: window.currentStream ? {
                        stream: window.currentStream,
                        scores: window.userScores
                    } : null
                })
            });

            const data = await response.json();

            // Remove typing indicator
            const typingIndicator = document.querySelector('.typing-indicator');
            if (typingIndicator) {
                typingIndicator.classList.add('d-none');
            }

            if (data.response) {
                // Add AI response
                addMistralMessage(data.response, 'ai');
                // Auto-scroll to bottom
                const chatContainer = document.getElementById('mistralChatContainer');
                chatContainer.scrollTop = chatContainer.scrollHeight;
            } else {
                addMistralMessage('Sorry, I encountered an error. Please try again.', 'ai');
            }
        } catch (error) {
            console.error('Error calling Mistral AI API:', error);
            // Remove typing indicator
            const typingIndicator = document.querySelector('.typing-indicator');
            if (typingIndicator) {
                typingIndicator.classList.add('d-none');
            }

            addMistralMessage('Sorry, I\'m having trouble connecting to the Mistral AI server. Please try again later.', 'ai');
        }
    }

    function addMistralMessage(text, sender) {
        const chatContainer = document.getElementById('mistralChatContainer');
        const messageBubble = document.createElement('div');
        messageBubble.className = `ai-message-bubble ${sender}-message`;

        const avatar = document.createElement('div');
        avatar.className = 'message-avatar';
        avatar.textContent = sender === 'ai' ? 'üß†' : 'üë§';

        const content = document.createElement('div');
        content.className = 'message-content';

        const messageText = document.createElement('div');
        messageText.className = 'message-text';
        messageText.innerHTML = formatMessage(text);

        content.appendChild(messageText);
        messageBubble.appendChild(avatar);
        messageBubble.appendChild(content);

        chatContainer.appendChild(messageBubble);

        // Auto-scroll to bottom
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function showMistralTypingIndicator() {
        const typingIndicator = document.querySelector('.typing-indicator');
        if (typingIndicator) {
            typingIndicator.classList.remove('d-none');
            // Scroll to show the typing indicator
            const chatContainer = document.getElementById('mistralChatContainer');
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    }

    // Enhanced message formatting
    function formatMessage(text) {
        return text
            .replace(/\n/g, '<br>')
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/`(.*?)`/g, '<code class="bg-light px-1 rounded">$1</code>');
    }

    // Event listeners for enhanced Mistral AI Counselor
    document.getElementById('mistralSendMessageBtn').addEventListener('click', sendMistralMessage);
    document.getElementById('mistralUserMessage').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            sendMistralMessage();
        }
    });

    // Add Enter key support for the input field
    document.getElementById('mistralUserMessage').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMistralMessage();
        }
    });

    // Enhanced suggestion badge click handler for Mistral
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('suggestion-badge') && e.target.closest('#mistral-counselor')) {
            const topic = e.target.getAttribute('data-topic');
            showMistralCounselingOptions(topic);
        }
    });
    
    // Interest Assessment Questions
    const assessmentQuestions = [
        {
            question: "Which of these subjects do you enjoy the most?",
            options: [
                { text: "Mathematics and Science", scores: { science: 3, commerce: 2, arts: 0, vocational: 1 } },
                { text: "Business and Economics", scores: { science: 1, commerce: 3, arts: 1, vocational: 1 } },
                { text: "Literature and Social Studies", scores: { science: 0, commerce: 1, arts: 3, vocational: 0 } },
                { text: "Practical and Technical Skills", scores: { science: 1, commerce: 0, arts: 0, vocational: 3 } }
            ]
        },
        {
            question: "What type of activities do you prefer?",
            options: [
                { text: "Conducting experiments and research", scores: { science: 3, commerce: 1, arts: 0, vocational: 1 } },
                { text: "Managing money or resources", scores: { science: 0, commerce: 3, arts: 1, vocational: 1 } },
                { text: "Creative writing or artistic expression", scores: { science: 0, commerce: 0, arts: 3, vocational: 1 } },
                { text: "Building or fixing things with hands", scores: { science: 1, commerce: 0, arts: 1, vocational: 3 } }
            ]
        },
        {
            question: "What kind of work environment do you prefer?",
            options: [
                { text: "Laboratory or research facility", scores: { science: 3, commerce: 1, arts: 0, vocational: 1 } },
                { text: "Office or corporate setting", scores: { science: 0, commerce: 3, arts: 1, vocational: 0 } },
                { text: "Creative studio or open space", scores: { science: 0, commerce: 1, arts: 3, vocational: 1 } },
                { text: "Workshop or hands-on setting", scores: { science: 1, commerce: 0, arts: 0, vocational: 3 } }
            ]
        },
        {
            question: "Which of these careers interests you the most?",
            options: [
                { text: "Scientist, Doctor, or Engineer", scores: { science: 3, commerce: 0, arts: 0, vocational: 0 } },
                { text: "Accountant, Entrepreneur, or Banker", scores: { science: 0, commerce: 3, arts: 0, vocational: 0 } },
                { text: "Writer, Artist, or Social Worker", scores: { science: 0, commerce: 0, arts: 3, vocational: 0 } },
                { text: "Technician, Chef, or Designer", scores: { science: 0, commerce: 0, arts: 1, vocational: 3 } }
            ]
        },
        {
            question: "What are your future education plans?",
            options: [
                { text: "Pursue engineering or medical studies", scores: { science: 3, commerce: 0, arts: 0, vocational: 0 } },
                { text: "Study business or finance", scores: { science: 0, commerce: 3, arts: 0, vocational: 0 } },
                { text: "Pursue liberal arts or social sciences", scores: { science: 0, commerce: 0, arts: 3, vocational: 0 } },
                { text: "Learn a specific trade or skill", scores: { science: 0, commerce: 0, arts: 0, vocational: 3 } }
            ]
        }
    ];

    // Quiz Questions
    const quizQuestions = {
        science: [
            {
                question: "Which subject do you find most interesting?",
                options: [
                    { text: "Physics", correct: true },
                    { text: "Business Studies", correct: false },
                    { text: "History", correct: false },
                    { text: "Home Science", correct: false }
                ]
            },
            {
                question: "What type of problems do you enjoy solving?",
                options: [
                    { text: "Mathematical equations", correct: true },
                    { text: "Financial calculations", correct: false },
                    { text: "Social issues", correct: false },
                    { text: "Design challenges", correct: false }
                ]
            }
        ],
        commerce: [
            {
                question: "Which activity interests you the most?",
                options: [
                    { text: "Analyzing financial statements", correct: true },
                    { text: "Conducting lab experiments", correct: false },
                    { text: "Writing poetry", correct: false },
                    { text: "Building furniture", correct: false }
                ]
            },
            {
                question: "What career path are you considering?",
                options: [
                    { text: "Chartered Accountant", correct: true },
                    { text: "Medical Doctor", correct: false },
                    { text: "Author", correct: false },
                    { text: "Electrician", correct: false }
                ]
            }
        ],
        arts: [
            {
                question: "Which subject excites you the most?",
                options: [
                    { text: "Literature", correct: true },
                    { text: "Chemistry", correct: false },
                    { text: "Accountancy", correct: false },
                    { text: "Computer Programming", correct: false }
                ]
            },
            {
                question: "What type of books do you prefer?",
                options: [
                    { text: "Novels and Poetry", correct: true },
                    { text: "Science Journals", correct: false },
                    { text: "Business Magazines", correct: false },
                    { text: "Technical Manuals", correct: false }
                ]
            }
        ],
        vocational: [
            {
                question: "What skills would you like to develop?",
                options: [
                    { text: "Technical and hands-on skills", correct: true },
                    { text: "Theoretical knowledge", correct: false },
                    { text: "Financial analysis", correct: false },
                    { text: "Research methodology", correct: false }
                ]
            },
            {
                question: "What's your ideal work environment?",
                options: [
                    { text: "Workshop or field work", correct: true },
                    { text: "Laboratory", correct: false },
                    { text: "Office", correct: false },
                    { text: "Classroom", correct: false }
                ]
            }
        ]
    };

    // Initialize variables
    let currentAssessmentQuestion = 0;
    let assessmentScores = { science: 0, commerce: 0, arts: 0, vocational: 0 };
    let currentQuiz = null;
    let currentQuizQuestion = 0;
    let quizScore = 0;
    let userAnswers = [];

    // DOM Elements
    const assessmentContainer = document.getElementById('assessmentContainer');
    const prevQuestionBtn = document.getElementById('prevQuestionBtn');
    const nextQuestionBtn = document.getElementById('nextQuestionBtn');
    const submitAssessmentBtn = document.getElementById('submitAssessmentBtn');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const assessmentResults = document.getElementById('assessmentResults');
    const quizContainer = document.getElementById('quizContainer');
    const quizQuestionContainer = document.getElementById('quizQuestionContainer');
    const quizTitle = document.getElementById('quizTitle');
    const quizProgress = document.getElementById('quizProgress');
    const prevQuizQuestionBtn = document.getElementById('prevQuizQuestionBtn');
    const nextQuizQuestionBtn = document.getElementById('nextQuizQuestionBtn');
    const submitQuizBtn = document.getElementById('submitQuizBtn');
    const quizResults = document.getElementById('quizResults');
    const quizScoreElement = document.getElementById('quizScore');
    const quizResultTitle = document.getElementById('quizResultTitle');
    const quizResultText = document.getElementById('quizResultText');
    const quizRecommendation = document.getElementById('quizRecommendation');
    const quizNextSteps = document.getElementById('quizNextSteps');

    // Initialize Assessment
    function showAssessmentQuestion(index) {
        const question = assessmentQuestions[index];
        let html = `
            <div class="question-container">
                <h5 class="mb-4">${index + 1}. ${question.question}</h5>
                <div class="options-container">
        `;

        question.options.forEach((option, i) => {
            html += `
                <button class="option-btn" data-index="${i}" onclick="selectOption(this, ${i})">
                    ${option.text}
                </button>
            `;
        });

        html += `
                </div>
            </div>
        `;

        assessmentContainer.innerHTML = html;
        updateNavigationButtons();
    }

    // Select Option in Assessment
    function selectOption(button, index) {
        // Remove selected class from all options
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('selected');
        });
        
        // Add selected class to clicked option
        button.classList.add('selected');
        
        // Enable next button
        nextQuestionBtn.disabled = false;
    }

    // Update Navigation Buttons
    function updateNavigationButtons() {
        prevQuestionBtn.disabled = currentAssessmentQuestion === 0;
        
        if (currentAssessmentQuestion === assessmentQuestions.length - 1) {
            nextQuestionBtn.classList.add('d-none');
            submitAssessmentBtn.classList.remove('d-none');
        } else {
            nextQuestionBtn.classList.remove('d-none');
            submitAssessmentBtn.classList.add('d-none');
        }
        
        // Update progress
        const progress = ((currentAssessmentQuestion + 1) / assessmentQuestions.length) * 100;
        progressBar.style.width = `${progress}%`;
        progressText.textContent = `${currentAssessmentQuestion + 1}/${assessmentQuestions.length}`;
    }

    // Submit Assessment
    function submitAssessment() {
        // Calculate results
        const maxScore = Math.max(...Object.values(assessmentScores));
        const recommendedStreams = [];
        
        if (assessmentScores.science === maxScore) recommendedStreams.push('Science');
        if (assessmentScores.commerce === maxScore) recommendedStreams.push('Commerce');
        if (assessmentScores.arts === maxScore) recommendedStreams.push('Arts/Humanities');
        if (assessmentScores.vocational === maxScore) recommendedStreams.push('Vocational');
        
        // Show results
        showResults();
    }

    // Show Assessment Results
    function showResults() {
        // Update progress bars
        const totalScore = Object.values(assessmentScores).reduce((a, b) => a + b, 0) || 1;
        
        document.querySelectorAll('.result-card').forEach(card => {
            const stream = card.classList[1];
            const score = assessmentScores[stream] || 0;
            const percentage = Math.round((score / totalScore) * 100);
            const progressBar = card.querySelector('.progress-bar');
            
            progressBar.style.width = `${percentage}%`;
            progressBar.setAttribute('aria-valuenow', percentage);
            progressBar.textContent = `${percentage}%`;
        });
        
        // Show results section
        document.querySelector('.form-container').classList.add('d-none');
        assessmentResults.classList.remove('d-none');
    }

    // Start Quiz
    function startQuiz(quizType) {
        currentQuiz = quizType;
        currentQuizQuestion = 0;
        quizScore = 0;
        userAnswers = [];
        
        // Update UI
        quizTitle.textContent = `${quizType.charAt(0).toUpperCase() + quizType.slice(1)} Stream Quiz`;
        quizContainer.classList.remove('d-none');
        quizResults.classList.add('d-none');
        
        // Hide quiz cards
        document.querySelectorAll('.quiz-card').forEach(card => {
            card.style.display = 'none';
        });
        
        showQuizQuestion();
    }

    // Show Quiz Question
    function showQuizQuestion() {
        const questions = quizQuestions[currentQuiz];
        const question = questions[currentQuizQuestion];
        
        // Update progress
        quizProgress.textContent = `${currentQuizQuestion + 1}/${questions.length}`;
        
        // Build question HTML
        let html = `
            <div class="question-container">
                <h5 class="mb-4">${currentQuizQuestion + 1}. ${question.question}</h5>
                <div class="options-container">
        `;
        
        question.options.forEach((option, index) => {
            const isSelected = userAnswers[currentQuizQuestion] === index;
            html += `
                <button class="option-btn ${isSelected ? 'selected' : ''}" 
                        onclick="selectQuizOption(this, ${index})">
                    ${option.text}
                </button>
            `;
        });
        
        html += `
                </div>
            </div>
        `;
        
        quizQuestionContainer.innerHTML = html;
        updateQuizNavigation();
    }

    // Select Quiz Option
    function selectQuizOption(button, optionIndex) {
        // Remove selected class from all options
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('selected');
        });
        
        // Add selected class to clicked option
        button.classList.add('selected');
        
        // Save user's answer
        userAnswers[currentQuizQuestion] = optionIndex;
        
        // Enable next button
        nextQuizQuestionBtn.disabled = false;
    }

    // Update Quiz Navigation
    function updateQuizNavigation() {
        const questions = quizQuestions[currentQuiz];
        
        prevQuizQuestionBtn.disabled = currentQuizQuestion === 0;
        nextQuizQuestionBtn.disabled = userAnswers[currentQuizQuestion] === undefined;
        
        if (currentQuizQuestion === questions.length - 1) {
            nextQuizQuestionBtn.classList.add('d-none');
            submitQuizBtn.classList.remove('d-none');
        } else {
            nextQuizQuestionBtn.classList.remove('d-none');
            submitQuizBtn.classList.add('d-none');
        }
    }

    // Submit Quiz
    function submitQuiz() {
        // Calculate score
        const questions = quizQuestions[currentQuiz];
        let correctAnswers = 0;
        
        questions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            if (userAnswer !== undefined && question.options[userAnswer].correct) {
                correctAnswers++;
            }
        });
        
        // Calculate percentage
        const percentage = Math.round((correctAnswers / questions.length) * 100);
        
        // Show results
        showQuizResults(percentage);
    }

    // Show Quiz Results
    function showQuizResults(percentage) {
        quizScore = percentage;
        
        // Update UI
        quizScoreElement.textContent = percentage;
        
        if (percentage >= 70) {
            quizResultTitle.textContent = 'Excellent!';
            quizResultText.textContent = 'You have a strong inclination towards this stream.';
            quizRecommendation.textContent = 'Based on your answers, this stream seems to be a great fit for you. Consider exploring career options in this field.';
        } else if (percentage >= 40) {
            quizResultTitle.textContent = 'Good Job!';
            quizResultText.textContent = 'You have some interest in this stream.';
            quizRecommendation.textContent = 'This stream could be a good option for you, but you might want to explore other streams as well to make an informed decision.';
        } else {
            quizResultTitle.textContent = 'Keep Exploring!';
            quizResultText.textContent = 'This stream might not be the best match for your interests.';
            quizRecommendation.textContent = 'Consider exploring other streams that might better align with your interests and strengths.';
        }
        
        // Add next steps
        const nextSteps = [
            'Research more about career options in this stream',
            'Talk to professionals working in this field',
            'Consider taking our detailed assessment',
            'Explore related subjects and courses'
        ];
        
        quizNextSteps.innerHTML = nextSteps.map(step => `<li><i class="fas fa-check-circle text-success me-2"></i>${step}</li>`).join('');
        
        // Show results
        quizContainer.classList.add('d-none');
        quizResults.classList.remove('d-none');
    }

    // Event Listeners for Assessment
    prevQuestionBtn.addEventListener('click', () => {
        if (currentAssessmentQuestion > 0) {
            currentAssessmentQuestion--;
            showAssessmentQuestion(currentAssessmentQuestion);
        }
    });
    
    nextQuestionBtn.addEventListener('click', () => {
        // Get selected option
        const selectedOption = document.querySelector('.option-btn.selected');
        if (selectedOption) {
            const optionIndex = parseInt(selectedOption.getAttribute('data-index'));
            const currentScores = assessmentQuestions[currentAssessmentQuestion].options[optionIndex].scores;
            
            // Update scores
            for (const stream in currentScores) {
                assessmentScores[stream] += currentScores[stream];
            }
            
            // Move to next question or show results
            if (currentAssessmentQuestion < assessmentQuestions.length - 1) {
                currentAssessmentQuestion++;
                showAssessmentQuestion(currentAssessmentQuestion);
            } else {
                submitAssessment();
            }
        }
    });
    
    submitAssessmentBtn.addEventListener('click', submitAssessment);
    
    // Event Listeners for Quiz
    document.querySelectorAll('.start-quiz-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            const quizType = e.target.getAttribute('data-quiz');
            startQuiz(quizType);
        });
    });
    
    exitQuizBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to exit the quiz? Your progress will be lost.')) {
            // Show quiz cards again
            document.querySelectorAll('.quiz-card').forEach(card => {
                card.style.display = 'block';
            });
            
            // Hide quiz container
            quizContainer.classList.add('d-none');
        }
    });
    
    prevQuizQuestionBtn.addEventListener('click', () => {
        if (currentQuizQuestion > 0) {
            currentQuizQuestion--;
            showQuizQuestion();
        }
    });
    
    nextQuizQuestionBtn.addEventListener('click', () => {
        if (currentQuizQuestion < quizQuestions[currentQuiz].length - 1) {
            currentQuizQuestion++;
            showQuizQuestion();
        }
    });
    
    submitQuizBtn.addEventListener('click', submitQuiz);
    
    retakeQuizBtn.addEventListener('click', () => {
        startQuiz(currentQuiz);
    });
    
    exploreMoreBtn.addEventListener('click', () => {
        // Show quiz cards again
        document.querySelectorAll('.quiz-card').forEach(card => {
            card.style.display = 'block';
        });
        
        // Hide quiz container and results
        quizContainer.classList.add('d-none');
        quizResults.classList.add('d-none');
    });
    
    retakeAssessmentBtn.addEventListener('click', () => {
        // Reset assessment
        currentAssessmentQuestion = 0;
        assessmentScores = { science: 0, commerce: 0, arts: 0, vocational: 0 };
        
        // Show first question
        showAssessmentQuestion(0);
        
        // Hide results
        assessmentResults.classList.add('d-none');
        document.querySelector('.form-container').classList.remove('d-none');
    });
    
    exploreCareersBtn.addEventListener('click', () => {
        // Show career exploration section
        // You can implement navigation to career exploration page here
        alert('Redirecting to career exploration page...');
    });

    // Initialize the first assessment question
    showAssessmentQuestion(0);
    
    // Initialize event listeners
    document.addEventListener('DOMContentLoaded', function() {
        // Previous/Next buttons for assessment
        document.getElementById('prevQuestion').addEventListener('click', function() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        });
        
        document.getElementById('nextQuestion').addEventListener('click', function() {
            if (currentQuestion < totalQuestions - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                // Finish assessment
                document.getElementById('assessmentQuestions').style.display = 'none';
                const resultsDiv = document.getElementById('assessmentResults');
                resultsDiv.innerHTML = `
                    <div class="card">
                        <div class="card-body text-center">
                            <h3>üéâ Assessment Complete!</h3>
                            <p>Based on your responses, here are some career suggestions:</p>
                            <div class="mt-4">
                                <span class="badge bg-primary m-1 p-2">Data Analyst</span>
                                <span class="badge bg-primary m-1 p-2">Software Developer</span>
                                <span class="badge bg-primary m-1 p-2">Research Scientist</span>
                            </div>
                            <button class="btn btn-primary mt-4" onclick="location.reload()">Take Another Assessment</button>
                        </div>
                    </div>
                `;
                resultsDiv.style.display = 'block';
            }
        });
    });
</script>
</body>
</html>
